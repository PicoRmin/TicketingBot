# ๐ฃ ูุงุฒ ฑฐ: ุณุณุชู ุงุนูุงูโูุง ู ููุชูฺฉุดู

## โ ูุงุจูุชโูุง ุชฺฉููโุดุฏู

- ููฺฉ ุดุฏู ุญุณุงุจ ุชูฺฏุฑุงู ฺฉุงุฑุจุฑ ุจุง ุญุณุงุจ ฺฉุงุฑุจุฑ (ุฏุฑ ุฒูุงู ูุฑูุฏ ุจู ุฑุจุงุช)
- ุงุฑุณุงู ุงุนูุงู ุชูฺฏุฑุงู ุจู ฺฉุงุฑุจุฑ ููฺฏุงู ุซุจุช ุชฺฉุช ุฌุฏุฏ
- ุงุฑุณุงู ุงุนูุงู ุชูฺฏุฑุงู ุจู ุงุฏููโูุง ููฺฏุงู ุซุจุช ุชฺฉุช ุฌุฏุฏ
- ุงุฑุณุงู ุงุนูุงู ุชูฺฏุฑุงู ููฺฏุงู ุชุบุฑ ูุถุนุช ุชฺฉุช (ุจุฑุง ฺฉุงุฑุจุฑ ู ุงุฏููโูุง)
- ุชุฑุฌูู ูพุงูโูุง ุงุนูุงู (ูุงุฑุณ ู ุงูฺฏูุณ)

ููุงุฑุฏ ฺฉู ุจุฑุง ุขูุฏู ุจุงู ูุงูุฏูโุงูุฏ:
- ุงุฑุณุงู ุงุนูุงู ุงูู (ุงุฎุชุงุฑ)
- ุชูุธูุงุช ุงุนูุงู ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ (ูุนุงู/ุบุฑูุนุงู)
- ุณุณุชู ุงุนูุงู ุจุฑุง ุณุงุฑ ฺฉุงูุงูโูุง (Webhookุ SMS ู ...)

## โ๏ธ ุชุบุฑุงุช ูู

### 1. ูุฏู ุฏุงุฏูโูุง
- ุงูุฒูุฏู ุณุชูู ุฌุฏุฏ `telegram_chat_id` ุจู ุฌุฏูู ฺฉุงุฑุจุฑุงู (`users`)
- ุงุฌุงุฏ Unique Index ุจุฑุง `telegram_chat_id`

### 2. API ุฌุฏุฏ
- `POST /api/auth/link-telegram`
  - ูุฑูุฏ: `chat_id` (ููุฑุงู ุจุง ููุงุฏุฑ ุงุฎุชุงุฑ `username`, `first_name`, `last_name`)
  - ูุฏู: ููฺฉ ฺฉุฑุฏู ุญุณุงุจ ุชูฺฏุฑุงู ฺฉุงุฑุจุฑ ุจุง ุณุณุชู

### 3. ุณุฑูุณ ุงุนูุงูโูุง
- ูุงู ุฌุฏุฏ `app/services/notification_service.py`
  - `notify_ticket_created`
  - `notify_ticket_status_changed`
- ุงุณุชูุงุฏู ุงุฒ `httpx` ุจุฑุง ุงุฑุณุงู Message ุจู Bot API ุชูฺฏุฑุงู

### 4. ุจุฑูุฒุฑุณุงู ุฑุจุงุช ุชูฺฏุฑุงู
- ุจุนุฏ ุงุฒ ูุฑูุฏ ููููุ ุฑุจุงุช ุขุฏ ฺฉุงุฑุจุฑ ุฑุง ุจู ุจฺฉโุงูุฏ ูโูุฑุณุชุฏ (`link_telegram_account`)

### 5. ุจุฑูุฒุฑุณุงู i18n
- ุงูุฒูุฏู ฺฉูุฏูุง ุฌุฏุฏ ุฏุฑ `fa.json` ู `en.json` ุจุฑุง ูพุงูโูุง ุงุนูุงู ู ุจุฑฺุณุจโูุง

## ๐ ูุญููโ ุฑุงูโุงูุฏุงุฒ / Migration

1. ุงุฌุฑุง ุงุณฺฉุฑูพุช ููุงุฌุฑุช ุจุฑุง ุณุชููโูุง ุฌุฏุฏ ุชฺฉุช (ุฏุฑ ุตูุฑุช ูุงุฒ):
   ```powershell
   python scripts/migrate_v6_add_ticket_columns.py
   ```

2. ุงุฌุฑุง ุงุณฺฉุฑูพุช ููุงุฌุฑุช ุจุฑุง ุณุชูู ุชูฺฏุฑุงู ฺฉุงุฑุจุฑุงู:
   ```powershell
   python scripts/migrate_v6_add_user_telegram.py
   ```

3. ุจุฑุฑุณ ุณุงุฎุชุงุฑ ุฌุฏุงูู:
   ```powershell
   python scripts/inspect_db.py
   ```

## ๐งช ูุญููโ ุชุณุช

1. **ููฺฉ ุดุฏู ุญุณุงุจ ุชูฺฏุฑุงู**
   - ูุงุฑุฏ ุฑุจุงุช ุดูุฏ (`/login`)
   - ุจุนุฏ ุงุฒ ูุฑูุฏ ููููุ ุฏุฑ ุจฺฉโุงูุฏ `telegram_chat_id` ุฐุฎุฑู ูโุดูุฏ

2. **ุซุจุช ุชฺฉุช ุฌุฏุฏ**
   - ุชฺฉุช ุฌุฏุฏ ุงุฌุงุฏ ฺฉูุฏ (ุงุฒ ุทุฑู ุฑุจุงุช ุง ูพูู ูุจ)
   - ฺฉุงุฑุจุฑ ุงุฌุงุฏฺฉููุฏู ู ููู ุงุฏููโูุง ฺฉู ุชูฺฏุฑุงู ุฑุง ููฺฉ ฺฉุฑุฏูโุงูุฏ ูพุงู ุฏุฑุงูุช ูโฺฉููุฏ

3. **ุชุบุฑ ูุถุนุช ุชฺฉุช**
   - ุงุฒ ูพูู ูุจ ุง API ูุถุนุช ุชฺฉุช ุฑุง ุชุบุฑ ุฏูุฏ
   - ูพุงู ุชุบุฑ ูุถุนุช ุจุฑุง ฺฉุงุฑุจุฑ ู ุงุฏููโูุง ุงุฑุณุงู ูโุดูุฏ

## ๐ ูฺฉุงุช ููู ุชูุณุนู

- ุงฺฏุฑ `TELEGRAM_BOT_TOKEN` ุฏุฑ `.env` ุฎุงู ุจุงุดุฏุ ุงุนูุงูโูุง ุงุฑุณุงู ููโุดููุฏ
- ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ูุบู ููฺฉ ุชูฺฏุฑุงูุ ููุฏุงุฑ `telegram_chat_id` ุฑุง ุจุฑุง ฺฉุงุฑุจุฑ `NULL` ฺฉูุฏ
- ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูพุงูโูุง ุชฺฉุฑุงุฑุ ุชููุง ฺฉุงุฑุจุฑุงู ููฺฉโุดุฏู ูพุงู ุฏุฑุงูุช ูโฺฉููุฏ

---

**ุชุงุฑุฎ ุจุฑูุฒุฑุณุงู**: 12 ุขุจุงู 1404 / 2025-11-12
